{% extends "base.html" %}

{% block title %}Advanced Mathematics - Math-Physics Suite{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-cube me-2"></i>Advanced Visualizations</h5>
            </div>
            <div class="card-body">
                <form method="POST" id="advancedForm">
                    <div class="mb-3">
                        <label for="viz_type" class="form-label">Select Visualization:</label>
                        <select class="form-select" id="viz_type" name="viz_type" onchange="showOptions()" required>
                            <option value="">-- Choose visualization --</option>
                            <option value="3d_surface">3D Surface Plot</option>
                            <option value="fourier">Fourier Series</option>
                            <option value="zeta">Riemann Zeta Function</option>
                        </select>
                    </div>
                    
                    <!-- 3D Surface Options -->
                    <div id="surfaceOptions" class="viz-options" style="display: none;">
                        <div class="mb-3">
                            <label class="form-label">Function z = f(x,y):</label>
                            <input type="text" class="form-control" name="surface_function" 
                                   placeholder="e.g., x**2 + y**2, sin(x)*cos(y)"
                                   value="x**2 + y**2">
                            <div class="form-text">
                                Use x and y as variables. Examples: x**2 + y**2, sin(x)*cos(y), exp(-(x**2 + y**2))
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fourier Series Options -->
                    <div id="fourierOptions" class="viz-options" style="display: none;">
                        <div class="mb-3">
                            <label class="form-label">Number of Terms:</label>
                            <select class="form-select" name="fourier_terms">
                                <option value="3">3 terms</option>
                                <option value="5" selected>5 terms</option>
                                <option value="10">10 terms</option>
                                <option value="20">20 terms</option>
                                <option value="50">50 terms</option>
                            </select>
                            <div class="form-text">
                                More terms = better approximation of square wave
                            </div>
                        </div>
                    </div>
                    
                    <!-- Zeta Function has no additional options -->
                    <div id="zetaOptions" class="viz-options" style="display: none;">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            The Riemann Zeta function ζ(s) will be plotted for real values of s from 0.1 to 10.
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" id="generateBtn" style="display: none;">
                        <i class="fas fa-magic me-2"></i>Generate Visualization
                    </button>
                    <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-home me-2"></i>Back to Dashboard
                    </a>
                </form>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-info-circle me-2"></i>Visualization Info</h6>
            </div>
            <div class="card-body" id="vizInfo">
                <div class="mb-3">
                    <strong>3D Surface Plot:</strong><br>
                    <small>Visualize functions of two variables z = f(x,y) in three dimensions.</small>
                </div>
                <div class="mb-3">
                    <strong>Fourier Series:</strong><br>
                    <small>Decompose periodic functions into sine and cosine components.</small>
                </div>
                <div class="mb-3">
                    <strong>Riemann Zeta:</strong><br>
                    <small>Famous function in number theory, ζ(s) = Σ(1/n^s).</small>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-lightbulb me-2"></i>3D Surface Examples</h6>
            </div>
            <div class="card-body small">
                <ul class="list-unstyled">
                    <li><code>x**2 + y**2</code> - Paraboloid</li>
                    <li><code>sin(x)*cos(y)</code> - Wave pattern</li>
                    <li><code>exp(-(x**2 + y**2))</code> - Gaussian</li>
                    <li><code>x**2 - y**2</code> - Saddle point</li>
                    <li><code>sqrt(x**2 + y**2)</code> - Cone</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-lg-8">
        {% if plot_html %}
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-area me-2"></i>
                    {{ plot_type }} Visualization
                </h5>
            </div>
            <div class="card-body">
                {{ plot_html|safe }}
                
                <div class="mt-3">
                    {% if plot_type == '3D Surface' %}
                    <div class="alert alert-info">
                        <h6><i class="fas fa-mouse me-2"></i>Interactive Controls:</h6>
                        <ul class="mb-0 small">
                            <li><strong>Rotate:</strong> Click and drag to rotate the surface</li>
                            <li><strong>Zoom:</strong> Use mouse wheel or pinch to zoom</li>
                            <li><strong>Pan:</strong> Hold shift and drag to pan</li>
                        </ul>
                    </div>
                    {% elif plot_type == 'Fourier Series' %}
                    <div class="alert alert-success">
                        <h6><i class="fas fa-wave-square me-2"></i>Fourier Series Approximation:</h6>
                        <p class="mb-0 small">
                            The blue line shows the Fourier series approximation of a square wave using the selected number of terms. 
                            More terms provide a better approximation with less ripple (Gibbs phenomenon).
                        </p>
                    </div>
                    {% elif plot_type == 'Riemann Zeta' %}
                    <div class="alert alert-warning">
                        <h6><i class="fas fa-infinity me-2"></i>Riemann Zeta Function:</h6>
                        <p class="mb-0 small">
                            The famous zeta function ζ(s) = 1 + 1/2^s + 1/3^s + ... 
                            Notice the pole at s=1 and how it approaches 1 as s increases.
                        </p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% else %}
        <div class="card">
            <div class="card-body text-center">
                <div class="py-5">
                    <i class="fas fa-cube fa-4x text-muted mb-3"></i>
                    <h5 class="text-muted">Select a visualization type</h5>
                    <p class="text-muted">Choose from 3D surfaces, Fourier series, or mathematical functions.</p>
                </div>
            </div>
        </div>
        {% endif %}

        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>Mathematical Concepts</h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="mb-3">
                            <h6 class="text-primary">3D Surfaces</h6>
                            <p class="small">Functions of two variables create surfaces in 3D space. Useful for optimization, physics, and engineering applications.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-3">
                            <h6 class="text-success">Fourier Analysis</h6>
                            <p class="small">Any periodic function can be represented as a sum of sine and cosine functions. Fundamental in signal processing.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-3">
                            <h6 class="text-warning">Number Theory</h6>
                            <p class="small">The Riemann Zeta function is central to understanding prime numbers and has deep connections to quantum physics.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-cogs me-2"></i>Technical Details</h6>
            </div>
            <div class="card-body">
                <div class="row small">
                    <div class="col-md-6">
                        <h6>Libraries Used:</h6>
                        <ul class="list-unstyled">
                            <li>• <strong>Plotly:</strong> Interactive 3D plotting</li>
                            <li>• <strong>NumPy:</strong> Numerical computations</li>
                            <li>• <strong>SymPy:</strong> Symbolic mathematics</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>Features:</h6>
                        <ul class="list-unstyled">
                            <li>• Interactive 3D navigation</li>
                            <li>• Real-time function evaluation</li>
                            <li>• High-resolution plotting</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function showOptions() {
    const vizType = document.getElementById('viz_type').value;
    const allOptions = document.querySelectorAll('.viz-options');
    const generateBtn = document.getElementById('generateBtn');
    
    // Hide all options
    allOptions.forEach(option => {
        option.style.display = 'none';
    });
    
    // Show relevant options
    if (vizType) {
        const optionsDiv = document.getElementById(vizType + 'Options');
        if (optionsDiv) {
            optionsDiv.style.display = 'block';
        }
        generateBtn.style.display = 'inline-block';
    } else {
        generateBtn.style.display = 'none';
    }
    
    // Update info panel
    updateInfoPanel(vizType);
}

function updateInfoPanel(vizType) {
    const infoPanel = document.getElementById('vizInfo');
    let content = '';
    
    switch(vizType) {
        case '3d_surface':
            content = `
                <div class="alert alert-primary">
                    <h6><i class="fas fa-cube me-2"></i>3D Surface Plot</h6>
                    <p class="mb-0 small">
                        Create interactive 3D visualizations of functions with two variables. 
                        Perfect for exploring mathematical surfaces, optimization problems, and multivariable calculus.
                    </p>
                </div>
            `;
            break;
        case 'fourier':
            content = `
                <div class="alert alert-success">
                    <h6><i class="fas fa-wave-square me-2"></i>Fourier Series</h6>
                    <p class="mb-0 small">
                        Decompose periodic functions into sine and cosine components. 
                        See how adding more terms improves the approximation of a square wave.
                    </p>
                </div>
            `;
            break;
        case 'zeta':
            content = `
                <div class="alert alert-warning">
                    <h6><i class="fas fa-infinity me-2"></i>Riemann Zeta Function</h6>
                    <p class="mb-0 small">
                        Explore the famous zeta function ζ(s) = Σ(1/n^s), central to number theory 
                        and the distribution of prime numbers.
                    </p>
                </div>
            `;
            break;
        default:
            content = `
                <div class="mb-3">
                    <strong>3D Surface Plot:</strong><br>
                    <small>Visualize functions of two variables z = f(x,y) in three dimensions.</small>
                </div>
                <div class="mb-3">
                    <strong>Fourier Series:</strong><br>
                    <small>Decompose periodic functions into sine and cosine components.</small>
                </div>
                <div class="mb-3">
                    <strong>Riemann Zeta:</strong><br>
                    <small>Famous function in number theory, ζ(s) = Σ(1/n^s).</small>
                </div>
            `;
    }
    
    infoPanel.innerHTML = content;
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    {% if plot_type %}
    document.getElementById('viz_type').value = '{{ plot_type.lower().replace(" ", "_").replace("riemann_zeta", "zeta") }}';
    showOptions();
    {% endif %}
});
</script>
{% endblock %}